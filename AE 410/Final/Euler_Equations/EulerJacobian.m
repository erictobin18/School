function amat = EulerJacobian(q, ~, g)
n = length(q);
amat = zeros(3,3,n);
one = ones(1,n);
% Create 3x3 array of vectors
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                                               amat(1,2,:) = one; 
amat(2,1,:) = -((g+1)/2)*(q(2,:)./q(1,:)).^2;  amat(2,2,:) = (g+1)*q(2,:)./q(1,:);                             amat(2,3,:) = (g-1)*one;
amat(3,1,:) = -g*q(3,:).*q(2,:)./q(1,:).^2;    amat(3,2,:) = g*q(3,:)./q(1,:)-(3/2)*(g-1)*(q(2,:)./q(1,:)).^2; amat(3,3,:) = g*q(2,:)./q(1,:);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
end